# Fitbit Integration Flow - Visual Guide

## ğŸ”„ Complete Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FITBIT INTEGRATION ARCHITECTURE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PHASE 1: ONE-TIME SETUP (You do this once)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                                                
    ğŸ–¥ï¸  You                                     ğŸ¢ Fitbit Developer Portal
    â”‚                                           â”‚
    â”‚  1. Register App                          â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚     - App Name: ACL Guardian              â”‚
    â”‚     - Callback: localhost:3000/...        â”‚
    â”‚                                           â”‚
    â”‚  2. Get Credentials                       â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚     âœ“ Client ID: 23ABCD                   â”‚
    â”‚     âœ“ Client Secret: abc123...            â”‚
    â”‚                                           â”‚
    â”‚  3. Save to .env file                     â”‚
    â”‚     FITBIT_CLIENT_ID=23ABCD               â”‚
    â”‚     FITBIT_CLIENT_SECRET=abc123...        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


PHASE 2: ATHLETE CONNECTS (First time per athlete)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    ğŸ‘¤ Athlete          ğŸŒ ACL Guardian       ğŸƒ Fitbit OAuth      ğŸ’¾ Database
    (Browser)           (Your App)            (Fitbit.com)         
    
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ 1. Click          â”‚                     â”‚                    â”‚
    â”‚ "Connect Fitbit"  â”‚                     â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 2. Generate         â”‚                    â”‚
    â”‚                   â”‚ OAuth URL           â”‚                    â”‚
    â”‚                   â”‚ + state + scopes    â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ 3. Redirect to Fitbit                   â”‚                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ 4. Fitbit Login   â”‚                     â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚   Email: athlete@email.com              â”‚                    â”‚
    â”‚   Password: ********                    â”‚                    â”‚
    â”‚                                         â”‚                    â”‚
    â”‚ 5. Authorize App                        â”‚                    â”‚
    â”‚   â˜‘ï¸  Activity                           â”‚                    â”‚
    â”‚   â˜‘ï¸  Heart Rate                         â”‚                    â”‚
    â”‚   â˜‘ï¸  Sleep                              â”‚                    â”‚
    â”‚   [ALLOW]                               â”‚                    â”‚
    â”‚                                         â”‚                    â”‚
    â”‚ 6. Redirect with code                   â”‚                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚ localhost:3000/api/fitbit/callback?     â”‚                    â”‚
    â”‚ code=xyz123&state=abc                   â”‚                    â”‚
    â”‚                                         â”‚                    â”‚
    â”‚                   â”‚ 7. Receive code     â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 8. Exchange code    â”‚                    â”‚
    â”‚                   â”‚ for tokens          â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚ POST /oauth2/token  â”‚                    â”‚
    â”‚                   â”‚ code=xyz123         â”‚                    â”‚
    â”‚                   â”‚ client_id=23ABCD    â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 9. Return tokens    â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {                   â”‚                    â”‚
    â”‚                   â”‚   access_token: ..  â”‚                    â”‚
    â”‚                   â”‚   refresh_token: .. â”‚                    â”‚
    â”‚                   â”‚   expires_in: 28800 â”‚                    â”‚
    â”‚                   â”‚ }                   â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 10. Encrypt & Save tokens                â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚    user_id: athlete_001                  â”‚
    â”‚                   â”‚    access_token: [ENCRYPTED]             â”‚
    â”‚                   â”‚    refresh_token: [ENCRYPTED]            â”‚
    â”‚                   â”‚    expires_at: 2025-11-01 18:00:00       â”‚
    â”‚                   â”‚                                          â”‚
    â”‚ 11. Success!      â”‚                                          â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                          â”‚
    â”‚ "Connected âœ“"     â”‚                                          â”‚
    â”‚                   â”‚                                          â”‚


PHASE 3: AUTOMATIC DATA SYNC (Every 15 minutes)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    â° Scheduler         ğŸ” Token Manager      ğŸ“Š Fitbit API       ğŸ’¾ Database
    
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ Every 15 min      â”‚                     â”‚                    â”‚
    â”‚ Trigger sync      â”‚                     â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 1. Get users        â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                   â”‚ [athlete_001, ...]  â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ For each user:      â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 2. Check token      â”‚                    â”‚
    â”‚                   â”‚ expiry              â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ IF expired:         â”‚                    â”‚
    â”‚                   â”‚ 3. Refresh token    â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚ POST /oauth2/token  â”‚                    â”‚
    â”‚                   â”‚ grant_type=refresh  â”‚                    â”‚
    â”‚                   â”‚ refresh_token=...   â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {new tokens}        â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 4. Fetch Activity   â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚ GET /1/user/-/      â”‚                    â”‚
    â”‚                   â”‚ activities/date/    â”‚                    â”‚
    â”‚                   â”‚ 2025-11-01.json     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {steps: 8432, ...}  â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 5. Fetch Heart Rate â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {resting: 62, ...}  â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 6. Fetch Sleep      â”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {duration: 28800..} â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ 7. Save to DB                            â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚ activity_data:                           â”‚
    â”‚                   â”‚   user_id: athlete_001                   â”‚
    â”‚                   â”‚   date: 2025-11-01                       â”‚
    â”‚                   â”‚   steps: 8432                            â”‚
    â”‚                   â”‚   resting_hr: 62                         â”‚
    â”‚                   â”‚   sleep_duration: 480                    â”‚
    â”‚                   â”‚   synced_at: NOW()                       â”‚
    â”‚                   â”‚                                          â”‚
    â”‚ âœ“ Sync complete   â”‚                                          â”‚
    â”‚                   â”‚                                          â”‚


PHASE 4: USER VIEWS DASHBOARD (Real-time)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    ğŸ‘¤ Athlete          ğŸŒ Frontend           ğŸ”§ Backend           ğŸ’¾ Database
    
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ Open app          â”‚                     â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚ GET /risk-assessmentâ”‚                    â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                   â”‚ user_id=athlete_001 â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚ Query latest data  â”‚
    â”‚                   â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚                     â”‚ SELECT * FROM      â”‚
    â”‚                   â”‚                     â”‚ activity_data      â”‚
    â”‚                   â”‚                     â”‚ WHERE user_id=...  â”‚
    â”‚                   â”‚                     â”‚ ORDER BY date DESC â”‚
    â”‚                   â”‚                     â”‚ LIMIT 14           â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                   â”‚                     â”‚ [14 days of data]  â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚ ğŸ¤– Run ML Model    â”‚
    â”‚                   â”‚                     â”‚ Calculate:         â”‚
    â”‚                   â”‚                     â”‚ - Asymmetry score  â”‚
    â”‚                   â”‚                     â”‚ - Load score       â”‚
    â”‚                   â”‚                     â”‚ - Impact score     â”‚
    â”‚                   â”‚                     â”‚ - Cadence score    â”‚
    â”‚                   â”‚                     â”‚ - Consistency      â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚                   â”‚ {                   â”‚                    â”‚
    â”‚                   â”‚   risk_score: 34,   â”‚                    â”‚
    â”‚                   â”‚   factors: {...},   â”‚                    â”‚
    â”‚                   â”‚   trends: {...}     â”‚                    â”‚
    â”‚                   â”‚ }                   â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
    â”‚ ğŸ“Š Dashboard      â”‚                     â”‚                    â”‚
    â”‚ âœ… Connected      â”‚                     â”‚                    â”‚
    â”‚ ğŸŸ¢ Risk: Low (34) â”‚                     â”‚                    â”‚
    â”‚ ğŸ“ˆ 14-day trends  â”‚                     â”‚                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                    â”‚
    â”‚                   â”‚                     â”‚                    â”‚
```

## ğŸ“Š Data Transformation Flow

```
RAW FITBIT DATA                ML PROCESSING              ACL RISK FACTORS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                â”â”â”â”â”â”â”â”â”â”â”â”â”              â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Steps: 12,453        â”€â”€â”€â”€â”€â”€â”
Distance: 9.2 km            â”‚
Active Minutes: 87          â”œâ”€â”€> Calculate       â”€â”€â”€â”€â”€â”€> ğŸ“Š Cadence Score
Time: 14 days               â”‚    Cadence:                   85/100 âœ…
                            â”‚    steps/active_min           (Healthy rhythm)
                            â”‚
                            â”‚
Heart Rate Zones:    â”€â”€â”€â”€â”€â”€â”¤
Peak: 12 min                â”‚
Cardio: 34 min              â”œâ”€â”€> Analyze         â”€â”€â”€â”€â”€â”€> ğŸ“Š Impact Score  
Out of Range: 540 min       â”‚    Intensity:                 42/100 âœ…
                            â”‚    peak/total                 (Moderate load)
                            â”‚
                            â”‚
Sleep: 7.5h daily    â”€â”€â”€â”€â”€â”€â”¤
Efficiency: 92%             â”‚
Stages: Deep/REM/Light      â”œâ”€â”€> Assess          â”€â”€â”€â”€â”€â”€> ğŸ“Š Consistency
Consistency: 6/7 days       â”‚    Recovery:                  78/100 âœ…
                            â”‚    sleep quality              (Good routine)
                            â”‚
                            â”‚
Steps variance:      â”€â”€â”€â”€â”€â”€â”¤
Mon: 8k, Tue: 15k           â”‚
Wed: 6k, Thu: 14k           â”œâ”€â”€> Detect          â”€â”€â”€â”€â”€â”€> ğŸ“Š Load Management
Pattern: Inconsistent       â”‚    Spikes:                    56/100 âš ï¸
                            â”‚    >50% jump?                 (Watch spikes!)
                            â”‚
                            â”‚
Left/Right balance:  â”€â”€â”€â”€â”€â”€â”˜
(Needs intraday data)       â”€â”€> Identify        â”€â”€â”€â”€â”€â”€> ğŸ“Š Asymmetry
Stride length                   Imbalance:                  PENDING
Ground contact time             left vs right               (Need approval)


                                    â¬‡ï¸
                            
                            ğŸ¯ FINAL RISK SCORE
                            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                            
                            Weighted Average:
                            â€¢ Asymmetry: 30%  â†’ 0 (pending)
                            â€¢ Load: 25%       â†’ 56 Ã— 0.25 = 14
                            â€¢ Impact: 20%     â†’ 42 Ã— 0.20 = 8.4
                            â€¢ Cadence: 15%    â†’ 85 Ã— 0.15 = 12.75
                            â€¢ Consistency: 10%â†’ 78 Ã— 0.10 = 7.8
                            
                            TOTAL: 43/100 ğŸŸ¡ MODERATE RISK
                            
                            Recommendation:
                            âœ“ Add warmup drills
                            âœ“ Reduce load spikes
                            âœ“ Continue monitoring
```

## ğŸ” Security Flow

```
CREDENTIAL STORAGE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. USER ENTERS CREDENTIALS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Fitbit OAuth Page    â”‚
   â”‚ Email: user@email    â”‚
   â”‚ Password: ******     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   
2. FITBIT RETURNS TOKENS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ access_token:        â”‚
   â”‚ "eyJhbGc..."         â”‚
   â”‚ (300 chars)          â”‚
   â”‚                      â”‚
   â”‚ refresh_token:       â”‚
   â”‚ "f8e9a2b..."         â”‚
   â”‚ (200 chars)          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   
3. BACKEND ENCRYPTS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ from cryptography    â”‚
   â”‚ import Fernet        â”‚
   â”‚                      â”‚
   â”‚ key = ENCRYPTION_KEY â”‚
   â”‚ cipher = Fernet(key) â”‚
   â”‚                      â”‚
   â”‚ encrypted = cipher   â”‚
   â”‚  .encrypt(token)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   
4. STORED IN DATABASE
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ users table:         â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ â”‚ access_token:    â”‚ â”‚
   â”‚ â”‚ gAAAAABg7Xz...   â”‚ â”‚  â† ENCRYPTED âœ…
   â”‚ â”‚ (unreadable)     â”‚ â”‚
   â”‚ â”‚                  â”‚ â”‚
   â”‚ â”‚ refresh_token:   â”‚ â”‚
   â”‚ â”‚ gAAAAABg8Az...   â”‚ â”‚  â† ENCRYPTED âœ…
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   
5. WHEN NEEDED, DECRYPT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ token = cipher       â”‚
   â”‚  .decrypt(encrypted) â”‚
   â”‚                      â”‚
   â”‚ use_for_api_call()   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  NEVER store plain tokens!
âš ï¸  NEVER log tokens!
âš ï¸  NEVER commit .env to git!
```

## ğŸ“± Mobile App Future

```
CURRENT ARCHITECTURE           FUTURE MOBILE APP
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”           â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Web Browser                     iOS/Android App
     â”‚                               â”‚
     â–¼                               â–¼
Next.js Frontend               React Native App
     â”‚                               â”‚
     â–¼                               â–¼
FastAPI Backend    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Same Backend!
     â”‚                                    â”‚
     â–¼                                    â–¼
Fitbit API                          Fitbit API
                                + Apple HealthKit
                                + Garmin Connect

Benefits of current design:
âœ… API-first architecture
âœ… Easy to add mobile later
âœ… Share same ML model
âœ… One codebase for data processing
```

---

**Ready to start building?** The visual flow should make it clear how everything connects! ğŸš€
